<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Review Popcorn Ultimate</title>

<style>
:root{
  --bg:#111;
  --card:#1c1c1c;
  --text:#fff;
  --accent:#2196f3;
}
body.light{
  --bg:#f5f5f5;
  --card:#fff;
  --text:#000;
}
body{
  margin:0;
  font-family:Arial;
  background:var(--bg);
  color:var(--text);
}
header{
  background:#000;
  padding:15px;
  display:flex;
  justify-content:space-between;
  align-items:center;
}
button{
  background:var(--accent);
  border:none;
  padding:6px 12px;
  color:white;
  border-radius:5px;
  cursor:pointer;
  margin:3px;
}
.grid{
  display:flex;
  gap:15px;
  overflow-x:auto;
  padding:20px;
}
.card{
  background:var(--card);
  min-width:180px;
  border-radius:8px;
  overflow:hidden;
  transition:0.3s;
}
.card:hover{
  transform:scale(1.08);
}
.card img{
  width:100%;
  height:250px;
  object-fit:cover;
}
.card .info{
  padding:10px;
  font-size:14px;
}
.star{
  color:gold;
  cursor:pointer;
  font-size:18px;
}
#trailerModal,
#detailsModal{
  position:fixed;
  top:0;left:0;
  width:100%;height:100%;
  background:rgba(0,0,0,0.8);
  display:none;
  justify-content:center;
  align-items:center;
}
#trailerModal iframe{
  width:80%;
  height:60%;
}
#detailsContent{
  background:white;
  color:black;
  max-width:700px;
  margin:auto;
  padding:20px;
  border-radius:10px;
  overflow:auto;
  max-height:90%;
}
</style>
</head>
<body>

<header>
<h2>üçø Review Popcorn</h2>
<div>
<button onclick="toggleMode()">üåô</button>
<button onclick="showWatchlist()">‚ù§Ô∏è Watchlist</button>
<button onclick="logout()">Logout</button>
</div>
</header>

<div style="text-align:center;padding:20px;">
<input id="searchInput" placeholder="Search movies or series">
<button onclick="search()">Search</button>
</div>

<div class="grid" id="movies"></div>

<!-- Trailer Modal -->
<div id="trailerModal" onclick="closeTrailer()">
<iframe id="trailerFrame" frameborder="0" allowfullscreen></iframe>
</div>

<!-- Details Modal -->
<div id="detailsModal">
  <div id="detailsContent">
    <h2 id="movieTitle"></h2>
    <p id="moviePlot"></p>
    <hr>
    <h3>üìñ Wikipedia Synopsis</h3>
    <p id="wikiContent"></p>
    <a id="wikiLink" target="_blank"></a>
    <br><br>
    <button onclick="closeDetails()">Close</button>
  </div>
</div>

<script>
const apiKey="88e73149";

/* LOGIN SYSTEM */
if(!localStorage.getItem("user")){
  const name=prompt("Enter your name to login:");
  if(name) localStorage.setItem("user",name);
}
function logout(){
  localStorage.removeItem("user");
  location.reload();
}

/* DARK MODE */
function toggleMode(){
  document.body.classList.toggle("light");
}

/* SEARCH */
async function search(){
  const query=document.getElementById("searchInput").value;
  if(!query) return;
  const res=await fetch(`https://www.omdbapi.com/?s=${query}&apikey=${apiKey}`);
  const data=await res.json();
  if(data.Response==="True"){
    display(data.Search);
  }
}

function display(list){
  const container=document.getElementById("movies");
  container.innerHTML="";
  list.forEach(item=>{
    const card=document.createElement("div");
    card.className="card";
    card.innerHTML=`
      <img src="${item.Poster}">
      <div class="info">
        <strong>${item.Title}</strong><br>
        ${item.Year}<br>
        <button onclick="watchTrailer('${item.Title}')">üéü Trailer</button>
        <button onclick="showDetails('${item.Title}')">üìñ Details</button>
        <button onclick="addWatchlist('${item.Title}')">‚ù§Ô∏è</button>
        <div>${generateStars(item.imdbID)}</div>
      </div>
    `;
    container.appendChild(card);
  });
}

/* TRAILER */
function watchTrailer(title){
  const url=`https://www.youtube.com/embed?listType=search&list=${title} trailer`;
  document.getElementById("trailerFrame").src=url;
  document.getElementById("trailerModal").style.display="flex";
}
function closeTrailer(){
  document.getElementById("trailerModal").style.display="none";
  document.getElementById("trailerFrame").src="";
}

/* WATCHLIST */
function addWatchlist(title){
  let list=JSON.parse(localStorage.getItem("watchlist")||"[]");
  if(!list.includes(title)){
    list.push(title);
    localStorage.setItem("watchlist",JSON.stringify(list));
    alert("Added to Watchlist ‚ù§Ô∏è");
  }
}
function showWatchlist(){
  const list=JSON.parse(localStorage.getItem("watchlist")||"[]");
  alert("Your Watchlist:\n\n"+list.join("\n"));
}

/* STAR RATING */
function generateStars(id){
  let stars="";
  for(let i=1;i<=5;i++){
    stars+=`<span class="star" onclick="rate('${id}',${i})">‚òÖ</span>`;
  }
  return stars;
}
function rate(id,value){
  localStorage.setItem("rating-"+id,value);
  alert("You rated "+value+" stars ‚≠ê");
}

/* DETAILS + WIKIPEDIA */
async function showDetails(title){

  const omdbRes = await fetch(`https://www.omdbapi.com/?t=${title}&plot=full&apikey=${apiKey}`);
  const omdbData = await omdbRes.json();

  document.getElementById("movieTitle").innerText = omdbData.Title;
  document.getElementById("moviePlot").innerText = omdbData.Plot;

  try{
    const wikiRes = await fetch(`https://en.wikipedia.org/api/rest_v1/page/summary/${title}`);
    const wikiData = await wikiRes.json();

    if(wikiData.extract){
      document.getElementById("wikiContent").innerText = wikiData.extract;
      document.getElementById("wikiLink").href = wikiData.content_urls.desktop.page;
      document.getElementById("wikiLink").innerText = "Read Full Article on Wikipedia";
    }else{
      document.getElementById("wikiContent").innerText="Wikipedia data not available.";
      document.getElementById("wikiLink").innerText="";
    }
  }catch{
    document.getElementById("wikiContent").innerText="Wikipedia data not available.";
  }

  document.getElementById("detailsModal").style.display="flex";
}

function closeDetails(){
  document.getElementById("detailsModal").style.display="none";
}
</script>

</body>
</html>
